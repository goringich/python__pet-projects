
# Документация по функциям работы с базой данных на основе pandas и Excel

Данный набор функций предназначен для управления базой данных, хранящейся в файле Excel. Используется библиотека `pandas` для обработки данных и `openpyxl` в качестве движка для чтения и записи Excel-файлов. Ниже представлены подробные описания каждой функции, их работа и оценка сложности.

![image](https://github.com/user-attachments/assets/2ad6c293-752f-4ea6-9bfa-e38f748faa0c)

---

## add_record

### Описание

Добавляет новую запись в базу данных после проверки уникальности ключа.

### Работа

1. Генерируется ключ на основе значений ключевых полей с помощью метода `_generate_key`.
2. Проверяется наличие ключа в `self.hash_table`.
3. Если ключ отсутствует, запись добавляется в `self.hash_table`.

### Код

```python
def add_record(self, record):
    """Добавление новой записи."""
    key = self._generate_key(record)  # Генерация ключа
    if key in self.hash_table:
        raise ValueError("Запись с таким ключом уже существует.")
    self.hash_table[key] = record  # Добавление в хеш-таблицу
```

### Сложность

- **Добавление:** \(O(1)\) — поиск и добавление в хеш-таблицу имеют константную сложность при отсутсвии коллизий.

---

## search_records

### Описание

Ищет запись по ключу.

### Работа

1. Генерируется ключ из переданных значений ключевых полей с помощью `_generate_key`.
2. Выполняется доступ к записи через `self.hash_table` по сгенерированному ключу.
3. Если ключ найден, возвращается запись. Если нет, выбрасывается ошибка.

### Код

```python
def search_records(self, key_values):
    """Поиск записи по ключу."""
    key = tuple(key_values)  # Генерация ключа
    if key in self.hash_table:
        return self.hash_table[key]  # Возвращение записи
    raise ValueError("Запись с таким ключом не найдена.")
```

### Сложность

- **Поиск:** \(O(1)\) — доступ к элементу в хеш-таблице осуществляется за константное время.

---

## delete_records

### Описание

Удаляет запись по ключу.

### Работа

1. Генерируется ключ из значений ключевых полей с помощью `_generate_key`.
2. Проверяется наличие ключа в `self.hash_table`.
3. Если ключ найден, запись удаляется из `self.hash_table`.

### Код

```python
def delete_records(self, key_values):
    """Удаление записи по ключу."""
    key = tuple(key_values)  # Генерация ключа
    if key in self.hash_table:
        del self.hash_table[key]  # Удаление записи
    else:
        raise ValueError("Запись с таким ключом не найдена.")
```

### Сложность

- **Удаление:** \(O(1)\) — удаление элемента из хеш-таблицы также выполняется за константное время.

---

## edit_record

### Описание

Редактирует существующую запись.

### Работа

1. Генерируется текущий ключ записи из переданных значений ключевых полей.
2. Проверяется существование записи с данным ключом.
3. Если ключ изменяется, старая запись удаляется, и новая запись добавляется с новым ключом.

### Код

```python
def edit_record(self, key_values, new_record):
    """Редактирование существующей записи."""
    key = tuple(key_values)  # Текущий ключ
    if key not in self.hash_table:
        raise ValueError("Запись для редактирования не найдена.")

    # Удаляем старую запись, если ключ изменяется
    old_record = self.hash_table[key]
    new_key = self._generate_key(new_record)
    if new_key != key and new_key in self.hash_table:
        raise ValueError("Запись с новым ключом уже существует.")
    del self.hash_table[key]  # Удаление старой записи
    self.hash_table[new_key] = new_record  # Добавление новой записи
```

### Сложность

- **Редактирование:** \(O(1)\) — удаление, проверка существования и добавление в хеш-таблицу выполняются за константное время.

---

## Заключение

Эти операции эффективны благодаря использованию хеш-таблицы (`self.hash_table`), обеспечивающей доступ к данным за константное время.

### Итоговая сложность операций

| **Операция**       | **Сложность** |
|---------------------|---------------|
| **Добавление**      | \(O(1)\)      |
| **Поиск**           | \(O(1)\)      |
| **Удаление**        | \(O(1)\)      |
| **Редактирование**  | \(O(1)\)      |
```
